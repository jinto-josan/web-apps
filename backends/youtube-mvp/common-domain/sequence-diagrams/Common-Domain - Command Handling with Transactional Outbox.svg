<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1025px" preserveAspectRatio="none" style="width:1949px;height:1025px;background:#FFFFFF;" version="1.1" viewBox="0 0 1949 1025" width="1949px" zoomAndPan="magnify"><title>Common-Domain - Command Handling with Transactional Outbox</title><defs/><g><text fill="#000000" font-family="'Helvetica'" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="441.0068" x="755.5874" y="25.7803">Common-Domain - Command Handling with Transactional Outbox</text><rect fill="none" height="208.1289" style="stroke:#000000;stroke-width:1.5;" width="1540.2959" x="321.5498" y="397.2832"/><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="23.7524" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="27" x2="27" y1="116.4883" y2="944.8281"/></g><g><title>API Controller</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="183.1362" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="187.1255" x2="187.1255" y1="116.4883" y2="944.8281"/></g><g><title>CommandHandler.UseCase</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="428.0928" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="431.5498" x2="431.5498" y1="116.4883" y2="944.8281"/></g><g><title>CorrelationContext</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="610.4985" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="613.6357" x2="613.6357" y1="116.4883" y2="944.8281"/></g><g><title>Tracer</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="720.8672" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="724.3613" x2="724.3613" y1="116.4883" y2="944.8281"/></g><g><title>UnitOfWork</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="805.4644" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="809.373" x2="809.373" y1="116.4883" y2="944.8281"/></g><g><title>Repository</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="904.6187" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="908.5557" x2="908.5557" y1="116.4883" y2="944.8281"/></g><g><title>Aggregate</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="999.7534" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1003.6816" x2="1003.6816" y1="116.4883" y2="944.8281"/></g><g><title>EventPublisher</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="1108.4473" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1111.8252" x2="1111.8252" y1="116.4883" y2="944.8281"/></g><g><title>OutboxRepository</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="1613.4229" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1616.9609" x2="1616.9609" y1="116.4883" y2="944.8281"/></g><g><title>IdGenerator</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="1739.022" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1742.8848" x2="1742.8848" y1="116.4883" y2="944.8281"/></g><g><title>Clock</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="1822.0024" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1825.1592" x2="1825.1592" y1="116.4883" y2="944.8281"/></g><g><title>Azure SQL</title><rect fill="#000000" fill-opacity="0.00000" height="828.3398" width="8" x="1906.0757" y="116.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1909.9697" x2="1909.9697" y1="116.4883" y2="944.8281"/></g><g class="participant participant-head" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5049" x="5" y="113.5352">Client</text><ellipse cx="27.7524" cy="48.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M27.7524,56.5 L27.7524,83.5 M14.7524,64.5 L40.7524,64.5 M27.7524,83.5 L14.7524,98.5 M27.7524,83.5 L40.7524,98.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5049" x="5" y="957.3633">Client</text><ellipse cx="27.7524" cy="968.8164" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M27.7524,976.8164 L27.7524,1003.8164 M14.7524,984.8164 L40.7524,984.8164 M27.7524,1003.8164 L14.7524,1018.8164 M27.7524,1003.8164 L40.7524,1018.8164" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Controller"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.0215" x="133.1255" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.0215" x="140.1255" y="105.5352">API Controller</text></g><g class="participant participant-tail" data-participant="Controller"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.0215" x="133.1255" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.0215" x="140.1255" y="964.3633">API Controller</text></g><g class="participant participant-head" data-participant="Handler"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="201.0859" x="331.5498" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.0859" x="338.5498" y="105.5352">CommandHandler/UseCase</text></g><g class="participant participant-tail" data-participant="Handler"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="201.0859" x="331.5498" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.0859" x="338.5498" y="964.3633">CommandHandler/UseCase</text></g><g class="participant participant-head" data-participant="Corr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143.7256" x="542.6357" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.7256" x="549.6357" y="105.5352">CorrelationContext</text></g><g class="participant participant-tail" data-participant="Corr"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143.7256" x="542.6357" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.7256" x="549.6357" y="964.3633">CorrelationContext</text></g><g class="participant participant-head" data-participant="Tracer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57.0117" x="696.3613" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.0117" x="703.3613" y="105.5352">Tracer</text></g><g class="participant participant-tail" data-participant="Tracer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57.0117" x="696.3613" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.0117" x="703.3613" y="964.3633">Tracer</text></g><g class="participant participant-head" data-participant="UoW"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.1826" x="763.373" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.1826" x="770.373" y="105.5352">UnitOfWork</text></g><g class="participant participant-tail" data-participant="UoW"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.1826" x="763.373" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.1826" x="770.373" y="964.3633">UnitOfWork</text></g><g class="participant participant-head" data-participant="Repo"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86.126" x="865.5557" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.126" x="872.5557" y="105.5352">Repository</text></g><g class="participant participant-tail" data-participant="Repo"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86.126" x="865.5557" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.126" x="872.5557" y="964.3633">Repository</text></g><g class="participant participant-head" data-participant="Agg"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84.1436" x="961.6816" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.1436" x="968.6816" y="105.5352">Aggregate</text></g><g class="participant participant-tail" data-participant="Agg"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84.1436" x="961.6816" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.1436" x="968.6816" y="964.3633">Aggregate</text></g><g class="participant participant-head" data-participant="Events"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.2441" x="1055.8252" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.2441" x="1062.8252" y="105.5352">EventPublisher</text></g><g class="participant participant-tail" data-participant="Events"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.2441" x="1055.8252" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.2441" x="1062.8252" y="964.3633">EventPublisher</text></g><g class="participant participant-head" data-participant="Outbox"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.9238" x="1548.9609" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.9238" x="1555.9609" y="105.5352">OutboxRepository</text></g><g class="participant participant-tail" data-participant="Outbox"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.9238" x="1548.9609" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.9238" x="1555.9609" y="964.3633">OutboxRepository</text></g><g class="participant participant-head" data-participant="IdGen"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94.2744" x="1695.8848" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.2744" x="1702.8848" y="105.5352">IdGenerator</text></g><g class="participant participant-tail" data-participant="IdGen"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94.2744" x="1695.8848" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.2744" x="1702.8848" y="964.3633">IdGenerator</text></g><g class="participant participant-head" data-participant="Clock"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.6865" x="1800.1592" y="85"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.6865" x="1807.1592" y="105.5352">Clock</text></g><g class="participant participant-tail" data-participant="Clock"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.6865" x="1800.1592" y="943.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.6865" x="1807.1592" y="964.3633">Clock</text></g><g class="participant participant-head" data-participant="SQL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.2119" x="1871.9697" y="113.5352">Azure SQL</text><path d="M1892.0757,64 C1892.0757,54 1910.0757,54 1910.0757,54 C1910.0757,54 1928.0757,54 1928.0757,64 L1928.0757,90 C1928.0757,100 1910.0757,100 1910.0757,100 C1910.0757,100 1892.0757,100 1892.0757,90 L1892.0757,64" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1892.0757,64 C1892.0757,74 1910.0757,74 1910.0757,74 C1910.0757,74 1928.0757,74 1928.0757,64" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="SQL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.2119" x="1871.9697" y="957.3633">Azure SQL</text><path d="M1892.0757,970.3164 C1892.0757,960.3164 1910.0757,960.3164 1910.0757,960.3164 C1910.0757,960.3164 1928.0757,960.3164 1928.0757,970.3164 L1928.0757,996.3164 C1928.0757,1006.3164 1910.0757,1006.3164 1910.0757,1006.3164 C1910.0757,1006.3164 1892.0757,1006.3164 1892.0757,996.3164 L1892.0757,970.3164" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1892.0757,970.3164 C1892.0757,980.3164 1910.0757,980.3164 1910.0757,980.3164 C1910.0757,980.3164 1928.0757,980.3164 1928.0757,970.3164" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="message" data-participant-1="Client" data-participant-2="Controller"><polygon fill="#181818" points="175.1362,143.7988,185.1362,147.7988,175.1362,151.7988,179.1362,147.7988" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="27.7524" x2="181.1362" y1="147.7988" y2="147.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="34.7524" y="143.0566">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.8081" x="47.3281" y="143.0566">POST /resource {...}</text></g><g class="message" data-participant-1="Controller" data-participant-2="Tracer"><polygon fill="#181818" points="712.8672,173.1094,722.8672,177.1094,712.8672,181.1094,716.8672,177.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="187.1362" x2="718.8672" y1="177.1094" y2="177.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="194.1362" y="172.3672">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.1108" x="206.7119" y="172.3672">startSpan("HTTP request", traceparent?)</text></g><g class="message" data-participant-1="Tracer" data-participant-2="Controller"><polygon fill="#181818" points="198.1362,202.4199,188.1362,206.4199,198.1362,210.4199,194.1362,206.4199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="192.1362" x2="723.8672" y1="206.4199" y2="206.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="204.1362" y="201.6777">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.5986" x="216.7119" y="201.6777">active span</text></g><g class="message" data-participant-1="Controller" data-participant-2="Corr"><polygon fill="#181818" points="602.4985,231.7305,612.4985,235.7305,602.4985,239.7305,606.4985,235.7305" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="187.1362" x2="608.4985" y1="235.7305" y2="235.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="194.1362" y="230.9883">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.6182" x="206.7119" y="230.9883">resolveCorrelationId(headers)</text></g><g class="message" data-participant-1="Corr" data-participant-2="Controller"><polygon fill="#181818" points="198.1362,261.041,188.1362,265.041,198.1362,269.041,194.1362,265.041" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="192.1362" x2="613.4985" y1="265.041" y2="265.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="204.1362" y="260.2988">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.063" x="216.7119" y="260.2988">correlationId</text></g><g class="message" data-participant-1="Controller" data-participant-2="Handler"><polygon fill="#181818" points="420.0928,290.3516,430.0928,294.3516,420.0928,298.3516,424.0928,294.3516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="187.1362" x2="426.0928" y1="294.3516" y2="294.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="194.1362" y="289.6094">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.3809" x="206.7119" y="289.6094">execute(command, correlationId)</text></g><g class="message" data-participant-1="Handler" data-participant-2="UoW"><polygon fill="#181818" points="797.4644,319.6621,807.4644,323.6621,797.4644,327.6621,801.4644,323.6621" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="803.4644" y1="323.6621" y2="323.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="439.0928" y="318.9199">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43.8115" x="451.6685" y="318.9199">begin()</text></g><g class="message" data-participant-1="Handler" data-participant-2="Repo"><polygon fill="#181818" points="896.6187,348.9727,906.6187,352.9727,896.6187,356.9727,900.6187,352.9727" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="902.6187" y1="352.9727" y2="352.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="439.0928" y="348.2305">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.1211" x="451.6685" y="348.2305">getById(command.id) or new</text></g><g class="message" data-participant-1="Repo" data-participant-2="Handler"><polygon fill="#181818" points="443.0928,378.2832,433.0928,382.2832,443.0928,386.2832,439.0928,382.2832" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="437.0928" x2="907.6187" y1="382.2832" y2="382.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="449.0928" y="377.541">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.3638" x="461.6685" y="377.541">Agg or null</text></g><path d="M321.5498,397.2832 L383.6885,397.2832 L383.6885,404.5938 L373.6885,414.5938 L321.5498,414.5938 L321.5498,397.2832" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="208.1289" style="stroke:#000000;stroke-width:1.5;" width="1540.2959" x="321.5498" y="397.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="336.5498" y="410.8516">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="42.8237" x="398.6885" y="409.918">[create]</text><g class="message" data-participant-1="Handler" data-participant-2="IdGen"><polygon fill="#181818" points="1731.022,431.9043,1741.022,435.9043,1731.022,439.9043,1735.022,435.9043" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="1737.022" y1="435.9043" y2="435.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="439.0928" y="431.1621">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.022" x="460.2441" y="431.1621">nextULID()</text></g><g class="message" data-participant-1="IdGen" data-participant-2="Handler"><polygon fill="#181818" points="443.0928,461.2148,433.0928,465.2148,443.0928,469.2148,439.0928,465.2148" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="437.0928" x2="1742.022" y1="465.2148" y2="465.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="449.0928" y="460.4727">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.2544" x="470.2441" y="460.4727">newId</text></g><g class="message" data-participant-1="Handler" data-participant-2="Clock"><polygon fill="#181818" points="1814.0024,490.5254,1824.0024,494.5254,1814.0024,498.5254,1818.0024,494.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="1820.0024" y1="494.5254" y2="494.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="439.0928" y="489.7832">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.5249" x="460.2441" y="489.7832">now()</text></g><g class="message" data-participant-1="Clock" data-participant-2="Handler"><polygon fill="#181818" points="443.0928,519.8359,433.0928,523.8359,443.0928,527.8359,439.0928,523.8359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="437.0928" x2="1825.0024" y1="523.8359" y2="523.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="449.0928" y="519.0938">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.0698" x="470.2441" y="519.0938">now</text></g><g class="message" data-participant-1="Handler" data-participant-2="Agg"><polygon fill="#181818" points="991.7534,549.1465,1001.7534,553.1465,991.7534,557.1465,995.7534,553.1465" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="997.7534" y1="553.1465" y2="553.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="439.0928" y="548.4043">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.084" x="460.2441" y="548.4043">create(command, now, newId)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="321.5498" x2="1861.8457" y1="562.1465" y2="562.1465"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="47.3247" x="326.5498" y="572.7813">[update]</text><g class="message" data-participant-1="Handler" data-participant-2="Agg"><polygon fill="#181818" points="991.7534,593.4121,1001.7534,597.4121,991.7534,601.4121,995.7534,597.4121" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="997.7534" y1="597.4121" y2="597.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="439.0928" y="592.6699">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.895" x="460.2441" y="592.6699">apply(command)</text></g><g class="message" data-participant-1="Agg" data-participant-2="Handler"><polygon fill="#181818" points="443.0928,629.7227,433.0928,633.7227,443.0928,637.7227,439.0928,633.7227" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="437.0928" x2="1002.7534" y1="633.7227" y2="633.7227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="449.0928" y="628.9805">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.3384" x="470.2441" y="628.9805">domainEvents[]</text></g><g class="message" data-participant-1="Handler" data-participant-2="Repo"><polygon fill="#181818" points="896.6187,659.0332,906.6187,663.0332,896.6187,667.0332,900.6187,663.0332" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="902.6187" y1="663.0332" y2="663.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="439.0928" y="658.291">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.9912" x="460.2441" y="658.291">save(Agg) ' includes optimistic version increment</text></g><g class="message" data-participant-1="Handler" data-participant-2="Events"><polygon fill="#181818" points="1100.4473,688.3438,1110.4473,692.3438,1100.4473,696.3438,1104.4473,692.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="1106.4473" y1="692.3438" y2="692.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="439.0928" y="687.6016">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.6592" x="460.2441" y="687.6016">publishAll(domainEvents) ' in-process</text></g><g class="message" data-participant-1="Events" data-participant-2="Outbox"><polygon fill="#181818" points="1605.4229,717.6543,1615.4229,721.6543,1605.4229,725.6543,1609.4229,721.6543" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1112.4473" x2="1611.4229" y1="721.6543" y2="721.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1119.4473" y="716.9121">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="459.8242" x="1140.5986" y="716.9121">append(domainEvents, metadata{correlationId, causationId, traceparent})</text></g><g class="message" data-participant-1="Outbox" data-participant-2="SQL"><polygon fill="#181818" points="1898.0757,746.9648,1908.0757,750.9648,1898.0757,754.9648,1902.0757,750.9648" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1617.4229" x2="1904.0757" y1="750.9648" y2="750.9648"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1624.4229" y="746.2227">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.5015" x="1645.5742" y="746.2227">INSERT outbox rows (same transaction)</text></g><g class="message" data-participant-1="SQL" data-participant-2="Outbox"><polygon fill="#181818" points="1628.4229,776.2754,1618.4229,780.2754,1628.4229,784.2754,1624.4229,780.2754" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1622.4229" x2="1909.0757" y1="780.2754" y2="780.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1634.4229" y="775.5332">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.5835" x="1655.5742" y="775.5332">ok</text></g><g class="message" data-participant-1="Handler" data-participant-2="UoW"><polygon fill="#181818" points="797.4644,805.5859,807.4644,809.5859,797.4644,813.5859,801.4644,809.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="432.0928" x2="803.4644" y1="809.5859" y2="809.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="439.0928" y="804.8438">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.9927" x="460.2441" y="804.8438">commit()</text></g><g class="message" data-participant-1="UoW" data-participant-2="SQL"><polygon fill="#181818" points="1898.0757,834.8965,1908.0757,838.8965,1898.0757,842.8965,1902.0757,838.8965" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="809.4644" x2="1904.0757" y1="838.8965" y2="838.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="816.4644" y="834.1543">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.4536" x="837.6157" y="834.1543">COMMIT</text></g><g class="message" data-participant-1="SQL" data-participant-2="UoW"><polygon fill="#181818" points="820.4644,864.207,810.4644,868.207,820.4644,872.207,816.4644,868.207" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="814.4644" x2="1909.0757" y1="868.207" y2="868.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="826.4644" y="863.4648">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.5835" x="847.6157" y="863.4648">ok</text></g><g class="message" data-participant-1="Handler" data-participant-2="Controller"><polygon fill="#181818" points="198.1362,893.5176,188.1362,897.5176,198.1362,901.5176,194.1362,897.5176" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="192.1362" x2="431.0928" y1="897.5176" y2="897.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="204.1362" y="892.7754">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.4399" x="225.2876" y="892.7754">result/view</text></g><g class="message" data-participant-1="Controller" data-participant-2="Client"><polygon fill="#181818" points="38.7524,922.8281,28.7524,926.8281,38.7524,930.8281,34.7524,926.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="32.7524" x2="186.1362" y1="926.8281" y2="926.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="44.7524" y="922.0859">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.6167" x="65.9038" y="922.0859">200/201/202</text></g><!--SRC=[XLHDRzim3BthLn2vp0RoqVNemuOkxTO0RPCr2NeOTb1iDXKgIvua9-cA_lTHaflQxh0Tya7nyP4Y7sKVXQguuINSQ-LkU8amk4IvGoToFc3sw7R2IVpwRup4BQhYFo2btTzvGWQOwhBKQdIkIouKZ8BDLG6Nz2M5si9Uk0TO6QuipvtGYakOrswZ3upNJgkwtA1XvD86fbAWSepoKWPHSULWSBQO4QToHak9PW3Sjimkj4aTCgEPh2rEkSKGqfprySQWvBueJua7rz2R7f2gpvlSyM_NlLR2pU_lj7aCaBM-w_fliT9Mq0MVWj-RlJjkjmQttCLQoUgwBtRKbKMzaS8-D6M48zk5nQxsaZMjxW1dnJTKQ3Y10YROlTP8dSVRX7-iu8vlg9bKw-_Q82o_NmKl_J8MnmQZJwt9PB2OBrSmCMXrRNA4v_5u_CBU01uUcvc1TPHxIPcJmULgjG23lsgqRZ04vn5K6V5_Jbd4mwYNoUjgXs29e9V0Zp83NmEfjZNkMP4y82_Gs9JvutUKUHlR8ssqb04UCAyT9ddKtR0RbR86w6D84nbiS2jKqZdtqyfWY-xB4zNK48r5aGAjWy8zyu1GtJ4hoICuQoaPbmvoWwISDccOPqRX1xU-cfrJnd3IfI5okbahAWoQplMU0eBH2z3xDfpAo9hSRmqWp30ofmmboQMkYbvn8OvNbNnw3IEeAfY_LYTV4LwKAFGVFzytpV8T9XILmWSGAfTrWHPqvKGfB0aPTZHT6eJt6IpzkzAYYBGPL76hpgHCslaYvwWoEaThMJpqSN6TmWMew4xC44fqt2_ASqS790jUswFHKlHBoYAVPwPDoc1sixouNO6EfqRlBIJMlxlkxVrC6K53grwBqO_lfEPRAnmDagmZ-tH-VJrR7SC3i1tRsm5QcrgwoKwG3DiR4BJYDpw3qvEJoUd9H_gS_W40]--></g></svg>